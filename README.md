# Hibernia
Hibernia - это система учёта и управления данными одноимённой школы ирландских танцев.
Комплекс включает в себя БД PostgreSQL, сервер на Node.js, и клиентское приложение на Vite. \
Данный проект является курсовой работой по дисциплине "Программные средства манипулирования данными".

## Скриншоты
![Страница авторизации](https://user-images.githubusercontent.com/47401054/208711085-ec5452ec-0f06-42a8-8f89-846cf6fae059.png)

[//]: # (![Главная страница]&#40;&#41;)

## Установка проекта (docker-compose)
```bash
git clone https://github.com/AipNooBest/Hibernia.git
cd Hibernia
sudo docker-compose up -d
```
При необходимости можно изменить переменные окружения в файле .env
```bash
mv .env.example .env
nano .env
```
| Имя переменной         | Значение по-умолчанию    | Описание                                                                                                                                                                                                                                                                                                                                                 |
|------------------------|--------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `DB_HOST`              | `localhost`              | Адрес расположения БД. Используется бэкендом для подключения к базе данных                                                                                                                                                                                                                                                                               |
| `DB_PORT`              | `5432`                   | Внешний порт БД. Используется во время инициализации БД, и **если бэкенд поднят не в докере**, то для подключения к БД                                                                                                                                                                                                                                   |
| `DB_NAME`              | `hibernia`               | Название БД. Используется во время инициализации БД, а также для подключения к БД из бэкенда                                                                                                                                                                                                                                                             |
| `DB_SULOGIN`           | `changeme`               | Логин суперпользователя БД                                                                                                                                                                                                                                                                                                                               |
| `DB_SUPASSWORD`        | `changeme`               | Пароль суперпользователя БД                                                                                                                                                                                                                                                                                                                              |
| `NODE_ENV`             | `production`             | Режим работы бэкенда. При использовании `production` используются только реальные переменные окружения, **не** из .env. При использовании `development` отключается проверка авторизации, а все ошибки БД отправляются в чистом виде в виде ответа. При любом другом значении используется .env, но имеется проверка авторизации, а ошибки отфильтрованы |
| `API_PORT`             | `3000`                   | Внешний порт работы бэкенда. Используется докером для прокидывания портов                                                                                                                                                                                                                                                                                |
| `SWAGGER_PORT`         | `8080`                   | Внешний порт сервиса документации                                                                                                                                                                                                                                                                                                                        |
| `TEST_USER`            | `changeme`               | Имя пользователя, от которого будут происходить запросы в режиме `development`.                                                                                                                                                                                                                                                                          |
| `TEST_PASSWORD`        | `changeme`               | Пароль пользователя ^                                                                                                                                                                                                                                                                                                                                    |
| `REDIS_URL`            | `redis://localhost:6379` | Адрес подключения к Redis. Используется бэкендом для подключения. В нем хранятся токены пользователей для того, чтобы при перезагрузке сервера не сбрасывались сессии. Изначально в контейнере порты **не** прокинуты, поэтому достучаться до него можно только из бэкенда по внутренней сети                                                            |
| `SESSION_LIFETIME_SEC` | `86400`                  | Время жизни сессии и токена пользователя в секундах. По истечению сессии токен удаляется из Redis, а сама сессия сбрасывается                                                                                                                                                                                                                            |

При первом запуске произойдет инициализация БД, создание суперпользователя и заполнение БД таблицами и прочим, но без данных. После этого можно перейти по адресу `http://localhost:8080` для просмотра документации.

## Установка проекта (вручную, без докера)
### Backend
```
git clone https://github.com/AipNooBest/Hibernia.git
cd Hibernia
npm install
npm run build
npm start
```
### База данных
```
sudo apt install postgresql
for file in ./database/*; do
    sudo -u postgres psql "${file}"
done
```
### Frontend
```
# В процессе...
```